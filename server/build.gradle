eclipse.project { name = appName + "-server" }

jar {
	from configurations.compile.collect { it.isDirectory() ? it : zipTree(it) }
	exclude "**/log4j2.xml"
	exclude "**/Log4j-*"
}

// Deploy to a server
// https://gradle-ssh-plugin.github.io/
remotes {
	jsvcServer {
		host = 'nog-jserver1.servehttp.com'
		user = 'ec2-user'
		knownHosts = allowAnyHosts
		identity = file('/Users/goshi/.ssh/GoshiNoguchi_tokyo.pem')
	}
}

task deploy(dependsOn: jar) << {
	ssh.run {
		session(remotes.jsvcServer) {
			put from: projectDir.getAbsolutePath() + '/build/libs/' + artifactName, into: '/usr/local/jmatcher'
			execute('sudo service jsvcd restart', pty: true)
		}
	}
}
